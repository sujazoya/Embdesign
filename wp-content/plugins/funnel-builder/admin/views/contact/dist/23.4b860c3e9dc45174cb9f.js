(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{523:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r(121),u=r(2),c=r(1),i=r(391),l=r(292),p=r(76),a=r(4),s=r(13),f=function(e){var t=Object(n.useRef)(!0),r=Object(l.a)(),o=r.getTemplates,c=r.getActiveBuilder,i=r.getActiveGroup,p=Object(u.isEmpty)(o()),a=i(),s=c();Object(n.useEffect)((function(){var r,n;t.current||!e.current||p||(n=null===(r=e.current)||void 0===r?void 0:r.getClientRects()[0].top)&&e.current&&n<252.86&&window.scrollTo(0,60)}),[p,a,s]),Object(n.useEffect)((function(){t.current&&!Object(u.isEmpty)(s)&&(window.scrollTo(0,0),t.current=!1)}),[s])},d=r(19),b=r(308);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.default=function(e){var t=Object(d.a)("ul").isProFeatureLocked,r=Object(l.a)(),m=r.getTemplates,v=r.getBuilders,y=(r.getFilters,r.getDefaultBuilder),h=r.templateLoading,w=r.getActiveBuilder,O=r.getActiveSubFilter,_=r.getActiveGroup,j=r.getCurrentTemplate,k=Object(p.a)().setActiveGroup,P=e.onImportComplete,S=e.isStoreCheckout,C=void 0!==S&&S,E=e.scratchConfirmModalData,T=e.storeCheckoutId,D=e.isStoreChekoutExists,F=void 0!==D&&D,A=e.templateListNotice,I=e.showImportNotice,N=e.urlDependency,B=void 0===N||N,x=e.showEditors,z=void 0===x||x,G=e.showTemplatesNav,L=void 0===G||G,R=e.showBuildFromScratch,J=void 0===R||R,M=e.showSelectedTemplates,U=void 0!==M&&M,Y=e.previewCustomizeEnabled,q=void 0!==Y&&Y,H=e.hideTabs,K=void 0===H?[]:H,Q=Object(s.i)().importType,V=m(),W=v(),X=JSON.parse(JSON.stringify(W)),Z=y(),$=w(),ee=h(),te=O(),re=j(),ne=Object(o.useParams)(),oe=ne.id,ue=void 0===oe?0:oe,ce=ne.filter,ie=void 0===ce?"funnel":ce,le=ne.builder,pe=ne.templateId,ae=ne.step,se=Object(n.useRef)();f(!Object(a.fb)()&&se);var fe,de=B?pe:re.id,be=B?ae:re.activeStep,me=C&&T?T:ue,ve=_(),ge=me||C||!B?ve:ie,ye={funnel:Object(c.__)("All","funnel-builder"),wc_checkout:Object(c.__)("Checkout","funnel-builder"),landing:Object(c.__)("Sales Funnels","funnel-builder"),optin:Object(c.__)("Lead Funnels","funnel-builder")};((me||F||K.includes("wc_checkout"))&&delete ye.wc_checkout,F&&(ye.upsell&&delete ye.upsell,me||(ye.wc_checkout=Object(c.__)("Checkout","funnel-builder"))),!t||me||K.includes("upsell")||(ye.upsell=Object(c.__)("One Click Upsell","funnel-builder")),X&&X.wc_checkout&&X.wc_checkout.customizer&&delete X.wc_checkout.customizer,"funnel"===Q)&&(null===(fe=X[ge])||void 0===fe||delete fe.wp_editor);Object(n.useEffect)((function(){return function(){k("funnel")}}),[]);var he=function(){var e=le||Z;return Object(u.isEmpty)($)||(e=$),X&&X[ge]&&!X[ge][e]&&(e=X[ge][Z]?Z:"elementor"),e},we=["1","2","3","inline","popup"],Oe=function(e,t){return("wc_checkout"===t||"optin"===t)&&te&&we.includes(te)?V[t][$][e].group_type[te]:e},_e={landing:"sp",optin:"op",optin_ty:"op-confirmed",wc_checkout:"checkouts",upsell:"offer",wc_thankyou:"order-confirmed"},je=function(e,t,r){var n=_e.hasOwnProperty(e)?_e[e]:"";return"oxy"===r&&(r="oxygen"),("customizer"===r||"wc_checkout"===e&&"wp_editor"===r)&&(r="elementor"),"https://templates-".concat(r,".funnelswp.com/").concat(n,"/").concat(t.prevslug,"/")},ke=Object(a.fb)()?"/store-checkout":me?"/funnels/".concat(me):"/templates";return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(i.a,{filters:b.e,templates:V,activeBuilder:he(),templateCards:function(){if(Object(u.isEmpty)(V)||Object(u.isEmpty)([ge]))return{};var e,t=he(),r={};if("upsell"===ge)r=null===(e=V[ge])||void 0===e?void 0:e[t];else if("funnel"===ge){var n=V[ge][t];for(var o in n){var c,i=n[o];if(n[o].hasOwnProperty("group")||U&&!U.includes(i.name))if(!(i.group.includes("sales")||i.group.includes("optin")||null!==(c=n[o])&&void 0!==c&&c.build_from_scratch))continue;r[o]=n[o]}}else for(var l in V.funnel[t]){var p=V.funnel[t][l];(!U||U&&U.includes(p.name))&&("landing"===ge&&p.group.includes("sales")||"optin"===ge&&p.group.includes("optin")||"wc_checkout"===ge&&p.group.includes("wc_checkout"))&&(r[l]=p)}return r}(),editors:X,defaultBuilder:Z,isTemplateLoading:ee,activeTemplateGroup:ge,templateGroup:ye,previewData:function(){if(Object(u.isEmpty)(V)||!de)return{};var e={success:!0},t=[],r=[];try{var n=he();if("upsell"===ge){t=[];var o=n;for(var i in"oxy"===o&&(o="oxygen"),"customizer"===o&&(o="elementor"),V[ge][n]){var l=V[ge][n][i];if(!l.build_from_scratch){var p={};p.id=i,p.funnel=i,p.slug=i,p.name=l.name,p.thumbnail=l.thumbnail,p.template=de,p.pro=l.pro,p.preview="https://templates-".concat(o,".funnelswp.com/offer/").concat(null==l?void 0:l.prevslug,"/"),p.group_type={},p.type="upsell",t.push(p),r.push({id:i,preview:"https://templates-".concat(o,".funnelswp.com/offer/").concat(null==l?void 0:l.prevslug,"/")})}}e.activeTemplate={id:de,thumbnail:de,preview:"https://templates-".concat(o,".funnelswp.com/offer/").concat(V[ge][n][de].prevslug,"/"),slug:de,prevId:de,name:V[ge][n][de].name,pro:V[ge][n][de].pro,tempPro:V[ge][n][de].pro,group:"upsell",type:"upsell"},e.thumbnails=t,e.previews=r}else{t=[];var a="funnel";switch(ge){case"optin":a="optin";break;case"landing":a="sales";break;case"wc_checkout":a="checkout"}var s=V.funnel[n][de];t=s.steps?s.steps.map((function(e){var t=V[e.type][n][Oe(e.slug,e.type)];if(void 0===t)throw new Error("Step template not found with slug "+Oe(e.slug,e.type));var o="";switch(e.type){case"landing":o=Object(c.__)("Sales Page","funnel-builder");break;case"wc_checkout":o=Object(c.__)("Checkout Page","funnel-builder");break;case"upsell":o=Object(c.__)("One Click Upsell","funnel-builder");break;case"wc_thankyou":o=Object(c.__)("Thank You Page","funnel-builder");break;case"optin":o=Object(c.__)("Optin Page","funnel-builder");break;case"optin_ty":o=Object(c.__)("Optin Confirmation Page","funnel-builder")}t.group_type?Object.values(t.group_type).forEach((function(t){var o=V[e.type][n][t];r.push({id:"".concat(e.type,"-").concat(o.prevslug),preview:je(e.type,o,n)})})):r.push({id:"".concat(e.type,"-").concat(t.prevslug),preview:je(e.type,t,n)});return{id:"".concat(e.type,"-").concat(de),slug:Oe(e.slug,e.type),funnel:de,step:e.type,name:o,thumbnail:null==t?void 0:t.thumbnail,pro:null==t?void 0:t.pro,type:"funnel",group:a,group_type:t.group_type||{},preview:je(e.type,t,n),filter:t.group?t.group[0]:""}})):[],e.thumbnails=t,e.previews=r;var f=s?s.steps.filter((function(e){return e.type===be})):[],d=V[f[0].type][n][Oe(f[0].slug,f[0].type)];e.activeTemplate={thumbnail:"".concat(be,"-").concat(de),prevId:"".concat(be,"-").concat(d.prevslug),preview:je(f[0].type,d,n),slug:de,name:V.funnel[n][de].name,pro:V.funnel[n][de].pro,tempPro:V.funnel[n][de].pro,group:"funnel",filters:!!d.group_type&&Object.keys(d.group_type),type:be,funnelGroup:s.group,filter:"wc_checkout"===be?d.no_steps:d.group?d.group[0]:""}}}catch(t){console.log("Failed to prepare template preview data:",t),e.success=!0}return e},funnelId:me,onImportComplete:P,templateFilterCheck:function(e){return!me||"funnel"===Q||!1===te||!1===te||!(!me||!e.group)&&(Array.isArray(e.group)?e.group.includes("inline"===te?"optin":te):te===e.group)},activeFilter:te,isStoreCheckout:C,parentRoute:ke,showTemplatesNav:L,showBuildFromScratch:!!J&&("funnel"!==Q||C&&!me),funnelTitleModalData:g({},C&&{title:Object(c.__)("Store Checkout","funnel-builder")}),scratchConfirmModalData:E,importApiPrefix:C?"store-checkout":"funnels",templateListNotice:A,showImportNotice:I,urlDependency:B,showEditors:z,previewCustomizeEnabled:q,listRef:se}))}}}]);